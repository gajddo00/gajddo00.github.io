(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[719],{4970:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/requests",function(){return n(6704)}])},8203:function(e,t){"use strict";t.Z={src:"/_next/static/media/arrow_back.b057c3f9.svg",height:9,width:6}},9661:function(e,t,n){"use strict";var r=n(5893),s=n(1163),a=n(8339),i=n(4574),c=n(5524);t.Z=function(e){var t,n=(0,s.useRouter)();return(0,r.jsx)("div",{className:"dialog-wrapper",children:(0,r.jsxs)("div",{className:"dialog",children:[(0,r.jsx)(a.Z,{type:"medium",children:e.title}),(0,r.jsx)(a.Z,{type:"body",className:"mt-2",children:e.message}),(0,r.jsxs)("div",{className:"flex justify-between mt-10",children:[(0,r.jsx)("button",{title:"cancel",onClick:function(){return e.setVisible(!1)},children:(0,i.K)("general.cancel",n.locale)}),(0,r.jsx)(c.Z,{type:"dark",label:null!==(t=e.actionTitle)&&void 0!==t?t:(0,i.K)("general.confirm",n.locale),onClick:e.action})]})]})})}},1089:function(e,t,n){"use strict";var r=n(5893),s=n(8203),a=n(5675),i=n.n(a);t.Z=function(e){return(0,r.jsx)("div",{className:e.className,children:(0,r.jsx)("button",{type:"button",className:"flex p-3 rounded-full ".concat(e.disabled||"bg-neutral-200"),onClick:e.onClick,disabled:e.disabled,children:(0,r.jsx)(i(),{className:"rotate-180",src:s.Z,height:15,width:15,alt:"paging-button"})})})}},7754:function(e,t,n){"use strict";var r=n(5893);function s(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}t.Z=function(e){var t=e.tabTitles,n=e.currentTab,a=s(e,["tabTitles","currentTab"]);return(0,r.jsx)("div",{className:"tabview",children:Array.from(Array(3)).map((function(e,s){return(0,r.jsx)("button",{className:"tab ".concat(n==s?"tab--active":""),onClick:function(){return a.tabChanged(s)},children:t[s]},s)}))})}},6704:function(e,t,n){"use strict";n.r(t),n.d(t,{RequestTab:function(){return E},default:function(){return P}});var r=n(4051),s=n.n(r),a=n(5893),i=n(1163),c=n(7294),o=n(1534),u=n(9661),l=n(7754),d=n(8339),v=n(8822),f=n(4574),h={src:"/_next/static/media/remove_icon.c54887c8.svg",height:12,width:12},p={src:"/_next/static/media/approve_icon.1f8fd69c.svg",height:12,width:12},x=n(5675),m=n.n(x),g=n(1089),j=function(e){var t=e.page,n=e.pages,r=e.count,s=e.setPage,c=(0,i.useRouter)();return 1==n?(0,a.jsx)(a.Fragment,{}):null!==r&&void 0!==r&&r?(0,a.jsxs)("div",{className:"flex mt-4 gap-3 justify-end",children:[(0,a.jsx)(g.Z,{className:"scale-x-flip",onClick:function(){return s(t-1)},disabled:1==t}),(0,a.jsx)(g.Z,{onClick:function(){return s(t+1)},disabled:n&&t==n||!1})]}):(0,a.jsx)(d.Z,{className:"mt-4",type:"body",children:(0,f.K)("general.noResults",c.locale)})},b=n(1664),w=n.n(b),y=n(5544),k=n(5538);function N(e,t,n,r,s,a,i){try{var c=e[a](i),o=c.value}catch(u){return void n(u)}c.done?t(o):Promise.resolve(o).then(r,s)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function i(e){N(a,r,s,i,c,"next",e)}function c(e){N(a,r,s,i,c,"throw",e)}i(void 0)}))}}var S=function(e){var t,n,r,u=(0,c.useState)(),l=u[0],d=u[1],x=(0,c.useState)(1),g=x[0],b=x[1],N=(0,c.useState)(!1),S=N[0],q=N[1],Z=(0,c.useState)(),A=Z[0],K=Z[1],R=new o.xq,P=(0,i.useRouter)(),_=(0,c.useMemo)((function(){return new AbortController}),[]),T=(0,c.useCallback)(C(s().mark((function t(){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.adminGetServiceRequests(g,10,{signal:_.signal});case 3:(n=t.sent).data.items&&(d(n.data),e.updateTabNotification(null!==(r=n.data.totalCount)&&void 0!==r?r:0,E.Services)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,v.U)(t.t0);case 10:return t.prev=10,q(!0),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))),[g]);return(0,c.useEffect)((function(){var e=new AbortController;return T(),function(){e.abort()}}),[g]),(0,c.useEffect)((function(){var e=function(){var e=C(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,R.adminApproveServiceRequest(null!==(t=null===A||void 0===A?void 0:A.serviceId)&&void 0!==t?t:"",{signal:_.signal});case 4:return n=e.sent,(0,k.Am)(n.data.message),e.next=8,T();case 8:K(void 0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,v.U)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();S&&e()}),[e.approved]),(0,c.useEffect)((function(){var e=function(){var e=C(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,R.adminRemoveServiceRequest(null!==(t=null===A||void 0===A?void 0:A.serviceId)&&void 0!==t?t:"",{signal:_.signal});case 4:return n=e.sent,(0,k.Am)(n.data.message),e.next=8,T();case 8:K(void 0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,v.U)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();S&&e()}),[e.denied]),S?(0,a.jsxs)("article",{className:"overflow-x-scroll sm:overflow-hidden",children:[(0,a.jsxs)("table",{className:"v-table w-full mt-5",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:(0,f.K)("user.name",P.locale)}),(0,a.jsx)("th",{children:"E-mail"}),(0,a.jsx)("th",{children:(0,f.K)("service.register.name",P.locale)}),(0,a.jsx)("th",{children:"URL"}),(0,a.jsx)("th",{children:(0,f.K)("service.register.minAuth",P.locale)}),(0,a.jsx)("th",{children:(0,f.K)("service.register.type",P.locale)}),(0,a.jsx)("th",{children:(0,f.K)("requests.action",P.locale)})]})}),(0,a.jsx)("tbody",{children:null===l||void 0===l||null===(t=l.items)||void 0===t?void 0:t.map((function(t,n){return(0,a.jsx)(w(),{passHref:!0,href:{pathname:"services/[id]",query:{id:t.serviceId}},children:(0,a.jsxs)("tr",{className:"selectable-row",children:[(0,a.jsx)("td",{children:t.userFullName}),(0,a.jsx)("td",{children:t.userEmail}),(0,a.jsx)("td",{children:t.serviceName}),(0,a.jsx)("td",{children:t.url}),(0,a.jsx)("td",{children:t.authMethod}),(0,a.jsx)("td",{children:t.serviceType}),(0,a.jsxs)("td",{children:[(0,a.jsx)("button",{className:"pr-2",onClick:function(n){n.preventDefault(),K(t),e.triggerDenyDialog()},children:(0,a.jsx)(m(),{src:h,height:20,width:20,alt:"Remove service request icon"})}),(0,a.jsx)("button",{onClick:function(n){n.preventDefault(),K(t),e.triggerApproveDialog()},children:(0,a.jsx)(m(),{src:p,height:20,width:20,alt:"Approve service request icon"})})]})]})},n)}))})]}),(0,a.jsx)(j,{page:g,pages:null!==(n=null===l||void 0===l?void 0:l.totalPages)&&void 0!==n?n:0,count:null!==(r=null===l||void 0===l?void 0:l.totalCount)&&void 0!==r?r:0,setPage:function(e){return b(e)}})]}):(0,a.jsx)(y.Z,{})};function q(e,t,n,r,s,a,i){try{var c=e[a](i),o=c.value}catch(u){return void n(u)}c.done?t(o):Promise.resolve(o).then(r,s)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function i(e){q(a,r,s,i,c,"next",e)}function c(e){q(a,r,s,i,c,"throw",e)}i(void 0)}))}}var A=function(e){var t,n,r,u=(0,c.useState)(),l=u[0],d=u[1],x=(0,c.useState)(1),g=x[0],b=x[1],w=(0,c.useState)(!1),N=w[0],C=w[1],S=(0,c.useState)(),q=S[0],A=S[1],K=new o.xq,R=(0,i.useRouter)(),P=(0,c.useMemo)((function(){return new AbortController}),[]),_=(0,c.useCallback)(Z(s().mark((function t(){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,K.adminGetServicesManagerRequests(g,10,{signal:P.signal});case 3:(n=t.sent).data.items&&(d(n.data),e.updateTabNotification(null!==(r=n.data.totalCount)&&void 0!==r?r:0,E.Users)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,v.U)(t.t0);case 10:return t.prev=10,C(!0),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))),[g]);return(0,c.useEffect)((function(){var e=new AbortController;return _(),function(){e.abort()}}),[g]),(0,c.useEffect)((function(){var e=function(){var e=Z(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.adminApproveServiceManagerRequest(null!==q&&void 0!==q?q:"",{signal:P.signal});case 3:return t=e.sent,(0,k.Am)(t.data.message),e.next=7,_();case 7:A(void 0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,v.U)(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();N&&e()}),[e.approved]),(0,c.useEffect)((function(){var e=function(){var e=Z(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.adminRemoveServiceManagerRequest(null!==q&&void 0!==q?q:"",{signal:P.signal});case 3:return t=e.sent,(0,k.Am)(t.data.message),e.next=7,_();case 7:A(void 0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,v.U)(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();N&&e()}),[e.denied]),N?(0,a.jsxs)("article",{className:"overflow-x-scroll sm:overflow-hidden",children:[(0,a.jsxs)("table",{className:"v-table w-full mt-5",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:(0,f.K)("user.name",R.locale)}),(0,a.jsx)("th",{children:"E-mail"}),(0,a.jsx)("th",{children:(0,f.K)("service.detail.org",R.locale)}),(0,a.jsx)("th",{children:(0,f.K)("requests.action",R.locale)})]})}),(0,a.jsx)("tbody",{children:null===l||void 0===l||null===(t=l.items)||void 0===t?void 0:t.map((function(t,n){return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"".concat(t.firstname," ").concat(t.lastname)}),(0,a.jsx)("td",{children:t.email}),(0,a.jsx)("td",{children:t.organization}),(0,a.jsxs)("td",{children:[(0,a.jsx)("button",{className:"pr-2",onClick:function(){t.userId&&(A(t.userId),e.triggerDenyDialog())},children:(0,a.jsx)(m(),{src:h,height:20,width:20,alt:"Remove service request icon"})}),(0,a.jsx)("button",{onClick:function(){t.userId&&(A(t.userId),e.triggerApproveDialog())},children:(0,a.jsx)(m(),{src:p,height:20,width:20,alt:"Approve service request icon"})})]})]},n)}))})]}),(0,a.jsx)(j,{page:g,pages:null!==(n=null===l||void 0===l?void 0:l.totalPages)&&void 0!==n?n:0,count:null!==(r=null===l||void 0===l?void 0:l.totalCount)&&void 0!==r?r:0,setPage:function(e){return b(e)}})]}):(0,a.jsx)(y.Z,{})},K=n(7313);function R(e,t,n,r,s,a,i){try{var c=e[a](i),o=c.value}catch(u){return void n(u)}c.done?t(o):Promise.resolve(o).then(r,s)}var E={Services:"Services",Users:"Users"},P=(0,K.H)((function(){var e=(0,c.useState)(0),t=e[0],n=e[1],r=(0,c.useState)(!1),v=r[0],h=r[1],p=(0,c.useState)(!1),x=p[0],m=p[1],g=(0,i.useRouter)(),j=new o.xq,b=(0,c.useState)(!1),w=b[0],y=b[1],k=(0,c.useState)(!1),N=k[0],C=k[1],q=(0,c.useState)((0,f.K)("services",g.locale)),Z=q[0],K=q[1],P=(0,c.useState)((0,f.K)("users",g.locale)),_=P[0],T=P[1];(0,c.useEffect)((function(){var e=new AbortController,t=function(){var t,n=(t=s().mark((function t(){var n,r,a,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.adminGetNotificationsCount({signal:e.signal});case 3:n=t.sent,r=n.data,D(null!==(a=r.serviceRequestsCount)&&void 0!==a?a:0,E.Services),D(null!==(i=r.serviceManagerRequestsCount)&&void 0!==i?i:0,E.Users),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])})),function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function i(e){R(a,r,s,i,c,"next",e)}function c(e){R(a,r,s,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return t(),function(){e.abort()}}),[]);var D=function(e,t){switch(t){case"Services":var n=(0,f.K)("services",g.locale);e>0?(n="".concat(n," (").concat(e,")"),K(n)):K(n);break;case"Users":var r=(0,f.K)("users",g.locale);e>0?(r="".concat(r," (").concat(e,")"),T(r)):T(r)}};return(0,a.jsxs)(a.Fragment,{children:[x&&(0,a.jsx)(u.Z,{title:(0,f.K)("general.confirmation",g.locale),message:(0,f.K)("requests.approve.message",g.locale),setVisible:m,action:function(){y((function(e){return!e})),m(!1)}}),v&&(0,a.jsx)(u.Z,{title:(0,f.K)("general.confirmation",g.locale),message:(0,f.K)("requests.remove.message",g.locale),setVisible:h,action:function(){C((function(e){return!e})),h(!1)}}),(0,a.jsxs)("section",{className:"pt-3 px-8",children:[(0,a.jsx)(d.Z,{type:"large",className:"self-start",children:(0,f.K)("requests",g.locale)}),(0,a.jsxs)("article",{className:"mt-10",children:[(0,a.jsx)(l.Z,{tabTitles:[Z,_],currentTab:t,tabChanged:function(e){return n(e)}}),function(){switch(t){case 0:return(0,a.jsx)(S,{triggerApproveDialog:function(){return m(!0)},triggerDenyDialog:function(){return h(!0)},approved:w,denied:N,updateTabNotification:D});case 1:return(0,a.jsx)(A,{triggerApproveDialog:function(){return m(!0)},triggerDenyDialog:function(){return h(!0)},approved:w,denied:N,updateTabNotification:D})}}()]})]})]})}))},7313:function(e,t,n){"use strict";n.d(t,{H:function(){return p}});var r=n(4051),s=n.n(r),a=n(5893),i=n(7294),c=n(2640),o=n(2855),u=n(1587),l=n(5544),d=n(8339),v=function(){return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("section",{className:"text-center",children:[(0,a.jsx)(d.Z,{className:"purple",type:"medium",children:"Forbidden access"}),(0,a.jsx)(d.Z,{type:"body",children:"You do not have permission to access this page."})]})})};function f(e,t,n,r,s,a,i){try{var c=e[a](i),o=c.value}catch(u){return void n(u)}c.done?t(o):Promise.resolve(o).then(r,s)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function i(e){f(a,r,s,i,c,"next",e)}function c(e){f(a,r,s,i,c,"throw",e)}i(void 0)}))}}var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(){var n=(0,i.useState)(!1),r=n[0],d=n[1],f=(0,i.useState)(!1),p=f[0],x=f[1],m=(0,c.Z)().auth,g=(0,u.Z)(),j=g.user,b=g.setUser,w=new o.Wj;return(0,i.useEffect)((function(){var e=new AbortController,t=function(){var t=h(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.userGetProfile({signal:e.signal});case 3:n=t.sent,b(n.data),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e.abort()}}),[]),(0,i.useEffect)((function(){d(void 0!==(null===m||void 0===m?void 0:m.token))}),[m]),(0,i.useEffect)((function(){0!=t.length?j&&j.role&&t.includes(j.role)&&x(!0):x(!0)}),[j]),r&&p?(0,a.jsx)(e,{}):j&&!p?(0,a.jsx)(v,{}):(0,a.jsx)(l.Z,{})}}}},function(e){e.O(0,[774,888,179],(function(){return t=4970,e(e.s=t);var t}));var t=e.O();_N_E=t}]);